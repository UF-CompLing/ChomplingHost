par(mfcol = c(3,2))
for(i in 1:6) {
x = ts(cumsum(rnorm(10000,.01,1)))
reg = lm(x~0+time(x), na.action=NULL)
plot(x)
lines(.01*time(x), col="blue", lty="dashed") # mean line
abline(reg, col="green") # regression line
}
par(mfcol = c(3,2))
for(i in 1:6) {
x = ts(cumsum(rnorm(100000,.01,1)))
reg = lm(x~0+time(x), na.action=NULL)
plot(x)
lines(.01*time(x), col="blue", lty="dashed") # mean line
abline(reg, col="green") # regression line
}
n = c(1,2,3,4)
n[1]
n[2]
par(mfcol = c(2,2))
n = c(100,1000,10000,100000) # expanding sample sizes
for(i in 1:4) {
x = ts(cumsum(rnorm(n[i],.01,1))) # retrives variable sample size
reg = lm(x~0+time(x), na.action=NULL)
plot(x)
lines(.01*time(x), col="blue", lty="dashed") # mean line
abline(reg, col="green") # regression line
}
par(mfcol = c(2,2))
n = c(1000,10000,100000,1000000) # expanding sample sizes
for(i in 1:4) {
x = ts(cumsum(rnorm(n[i],.01,1))) # retrives variable sample size
reg = lm(x~0+time(x), na.action=NULL)
plot(x)
lines(.01*time(x), col="blue", lty="dashed") # mean line
abline(reg, col="green") # regression line
}
data(gtemp)
library(datasets)
data(gtemp)
library(astsa)
data("gtemp")
plot(gtemp)
ma5 = filter(gtemp,sides=2,rep(1,5)/5)
ma5 = filter(gtemp,sides=2,rep(1,5)/5)
lines(ma5)
ma53 = filter(gtemp, sides=2,rep(1,53)/53)
lines(ma53)
data(gtemp) # Select and plot base dataset
par(mfrow=c(2,1))
plot(gtemp)
# Smoother 1: Moving average
ma25 = filter(gtemp,sides=2, rep(1,25)/25)
lines(ma25,col="blue")
range(gtemp)
str(gtemp)
data(gtemp) # Prepare and plot data
plot(gtemp)
# Method 1: 5-point (year) Moving average
lines(filter(gtemp,sides=2, rep(1,5)/5),col="blue")
# Method 2: Kernel Smoother
lines(ksmooth(time(gtemp),gtemp,bandwith=5),col="green")
data(gtemp) # Prepare and plot data
plot(gtemp)
# Method 1: 5-point (year) Moving average
lines(filter(gtemp,sides=2, rep(1,5)/5),col="blue")
lines(ksmooth(time(gtemp),gtemp,bandwidth=5),col="green")
data(gtemp) # Prepare and plot data
plot(gtemp)
# Method 1: 5-point (year) Moving average
lines(filter(gtemp,sides=2, rep(1,5)/5),col="blue")
# Method 2: Kernel Smoother
lines(ksmooth(time(gtemp),gtemp,bandwidth=5),col="green")
data(gtemp) # Prepare and plot data
plot(gtemp)
# Method 1: 5-point (year) Moving average
lines(filter(gtemp,sides=2, rep(1,5)/5),col="blue")
# Method 2: Kernel Smoother
lines(ksmooth(time(gtemp),gtemp,bandwidth=5),col="green")
data(gtemp) # Prepare and plot data
plot(gtemp)
# Method 1: 5-point (year) Moving average
lines(filter(gtemp,sides=2, rep(1,5)/5),col="blue")
# Method 2: Kernel Smoother
lines(ksmooth(time(gtemp),gtemp,bandwidth=5),col="green")
data(gtemp) # Prepare and plot data
plot(gtemp)
data(gtemp) # Prepare and plot data
plot(gtemp)
data(gtemp) # Prepare and plot data
plot(gtemp)
# Method 1: 5-point (year) Moving average
lines(filter(gtemp,sides=2, rep(1,5)/5),col="blue")
# Method 2: Kernel Smoother
lines(ksmooth(time(gtemp),gtemp,bandwidth=5),col="green",lty="dashed")
lines(filter(gtemp,sides=2, rep(1,5)/5),col="blue")
lines(ksmooth(time(gtemp),gtemp,bandwidth=5),col="green",lty="dashed")
```
lines(smooth.spline(time(gtemp),gtemp,bandwidth=5),col="green",lty="dashed")
lines(smooth.spline(time(gtemp),gtemp),col="green",lty="dashed")
data(gtemp) # Prepare and plot data
plot(gtemp,main="5-year Moving Average vs. Spline Smoothing on 'gtemp' data")
# Method 1: 5-point (year) Moving average
lines(filter(gtemp,sides=2, rep(1,5)/5),col="blue")
data(gtemp) # Prepare and plot data
plot(gtemp,main="5-year Moving Average (blue/solid) vs. Spline (green/dashed) Smoothing on 'gtemp' data")
# Method 1: 5-point (year) Moving average
lines(filter(gtemp,sides=2, rep(1,5)/5),col="blue")
# Method 2: Kernel Smoother
lines(smooth.spline(time(gtemp),gtemp),col="green",lty="dashed")
```
par(mfrow=c(3,1))
plot(cmort, main="Cardiovascular Mortality", xlab="", ylab="")
plot(tempr, main="Temperature", xlab="", ylab="")
plot(part, main="Particulates", xlab="", ylab="")
dev.new() # open a new graphic device for the scatterplot matrix
par(mfrow=c(3,1))
plot(cmort, main="Cardiovascular Mortality", xlab="", ylab="")
plot(tempr, main="Temperature", xlab="", ylab="")
plot(part, main="Particulates", xlab="", ylab="")
dev.new() # open a new graphic device for the scatterplot matrix
pairs(cbind(Mortality=cmort, Temperature=tempr, Particulates=part))
temp = tempr-mean(tempr) # center temperature
pairs(cbind(Mortality=cmort, Temperature=tempr, Particulates=part))
pairs(cbind(Mortality=cmort, Temperature=tempr, Particulates=part))
par(mfrow=c(3,1))
plot(cmort, main="Cardiovascular Mortality", xlab="", ylab="")
plot(tempr, main="Temperature", xlab="", ylab="")
plot(part, main="Particulates", xlab="", ylab="")
pairs(cbind(Mortality=cmort, Temperature=tempr, Particulates=part))
temp = tempr-mean(tempr) # center temperature
temp2 = temp^2
trend = time(cmort) # time
fit = lm(cmort~ trend + temp + temp2 + part, na.action=NULL)
summary(fit) # regression results
summary(aov(fit)) # ANOVA table
(compare to next line)
summary(aov(lm(cmort~cbind(trend, temp, temp2, part)))) # Table 2.1
summary(aov(fit)) # ANOVA table
summary(aov(lm(cmort~cbind(trend, temp, temp2, part)))) # Table 2.1
num = length(cmort) # sample size
AIC(fit)/num - log(2*pi) # AIC
AIC(fit, k=log(num))/num - log(2*pi) # BIC
(AICc = log(sum(resid(fit)^2)/num) + (num+5)/(num-5-2)) # AICc
```
pairs(cbind(Mortality=cmort, Temperature=tempr, Particulates=part))
pairs(cbind(Mortality=cmort, Temperature=tempr, Particulates=part))
library(astsa)
temp = tempr-mean(tempr) # center temperature
temp2 = temp^2
trend = time(cmort) # time
partm4 = lag(part,k=-4)
head(cbind(part,partm4));
tail(cbind(part,partm4))
x <- head(partm4)
x
head(cbind(part,partm4));
tail(cbind(part,partm4))
head(cbind(part,partm4))
head(cbind(part,partm4))[-4]
head(cbind(part,partm4))[1:4]
head(cbind(part,partm4))[-1,]
head(cbind(part,partm4))[-4,]
head(cbind(part,partm4))[-4,]
head(cbind(part,partm4))[-1,]
head(cbind(part,partm4))
head(cbind(part,partm4))[-2,]
head(cbind(part,partm4))[-6,]
head(cbind(part,partm4))[-1:4,]
head(cbind(part,partm4))[-(1:4),]
head(cbind(part,partm4))[-1:4,]
head(cbind(part,partm4))[-(1:4),]
x = partm4
head(x)
x = cbind(part,partm4)
head(x)
x = x[-(1:4)]
x
head(x)
tail(x)
x
x = cbind(part,partm4)
x
head(cbind(part,partm4))[-(1:4),]
tail(cbind(part,partm4))[-(1:4),]
x = cbind(part,partm4)
dim(x)
length(dim(head(x,-4)))
head(x)
head(x,-4)
head(head(x,-4))
head(head(x,4))
y = head(x[-(1:4),],-4)
dim(y)
dim(x)
head(x)
tail(x)
tail(head(x,-3))
tail(head(x,-4))
dim(tail(head(x,-4)))
y = head(x[-(1:4),],-4)
dim(y)
library(astsa)
# Previous data preparation
temp = tempr-mean(tempr) # center temperature
temp2 = temp^2
trend = time(cmort) # time
# Set part(t-4) value, trimmed head/tail by 4 values to remove NA
partm4 = lag(part,k=-4)
temp = head(temp[-(1:4),],-4)
dim(temp)
temp
dim(temp)
dim(cmort)
str(cmort)
library(astsa)
# Previous data preparation
temp = tempr-mean(tempr) # center temperature
temp2 = temp^2
trend = time(cmort) # time
# Set part(t-4) value, trimmed head/tail by 4 values to remove NA
partm4 = lag(part,k=-4)
temp = head(temp[-(1:4),],-4)
temp2 = head(temp2[-(1:4),],-4)
trend = head(trend[-(1:4),],-4)
part = head(part[-(1:4),],-4)
?lm
fit = lm(cmort~ trend + temp + temp2 + part, na.action="na.omit")
summary(fit) # regression results
summary(aov(fit)) # ANOVA table
summary(aov(lm(cmort~cbind(trend, temp, temp2, part)))) # Table 2.1
num = length(cmort) # sample size
AIC(fit)/num - log(2*pi) # AIC
AIC(fit, k=log(num))/num - log(2*pi) # BIC
(AICc = log(sum(resid(fit)^2)/num) + (num+5)/(num-5-2)) # AICc
plot(cmort)
line(fit,col="blue")
lines(fit,col="blue")
abline(fit,col="blue")
# Added part(t-4) value to model
fit = lm(cmort~ trend + temp + temp2 + part, na.action=NULL)
abline(fit,col="blue")
plot(fit)
lines(fit,col="blue")
library(astsa)
# Previous data preparation
temp = tempr-mean(tempr) # center temperature
temp2 = temp^2
trend = time(cmort) # time
# Set part(t-4) value
partm4 = lag(part,k=-4)
# Added part(t-4) value to model
fit = lm(cmort~ trend + temp + temp2 + part + partm4, na.action=NULL)
summary(fit) # regression results
fit = lm(cmort~ trend + temp + temp2 + part + partm4, na.action="na.omit")
summary(fit) # regression results
fit = lm(cmort~ trend + temp + temp2 + part, na.action="na.omit")
summary(fit) # regression results
summary(aov(fit)) # ANOVA table
partm4 = lag(part,k=-4)
plot(partm4)
lines(part,col="blue")
plot(lm(cmort~trend+temp+temp2+part+partm4,na.action="na.omit"))
abline(fit)
?abline
pairs(cbind(Mortality=cmort, Temperature=tempr, Particulates=part,ParticulatesTMinus4=partm4))
AIC(fit)/num - log(2*pi) # AIC
AIC(fit, k=log(num))/num - log(2*pi) # BIC
num = length(cmort) # sample size
summary(aov(lm(cmort~cbind(trend, temp, temp2, part)))) # Table 2.1
num = length(cmort) # sample size
AIC(fit)/num - log(2*pi) # AIC
AIC(fit, k=log(num))/num - log(2*pi) # BIC
(AICc = log(sum(resid(fit)^2)/num) + (num+5)/(num-5-2)) # AICc
?pairs
cor(cbind(Mortality=cmort, Temperature=tempr, Particulates=part,ParticulatesTMinus4=partm4))
cor(cbind(Mortality=cmort, Temperature=tempr, Particulates=part,ParticulatesTMinus4=partm4))
?cor
cor(cbind(Mortality=cmort, Temperature=tempr, Particulates=part,ParticulatesTMinus4=partm4),na.rm="na.omit")
cor(cbind(Mortality=cmort, Temperature=tempr, Particulates=part,ParticulatesTMinus4=partm4),na.rm=TRUE)
cor(cbind(Mortality=cmort, Temperature=tempr, Particulates=part,ParticulatesTMinus4=partm4),USE="complete.obs")
cor(cbind(Mortality=cmort, Temperature=tempr, Particulates=part,ParticulatesTMinus4=partm4),use="complete.obs")
pairs(cbind(Mortality=cmort, Temperature=tempr, Particulates=part,ParticulatesTMinus4=partm4))
# Components of code provided in textbook, courtesy of Shumway and Stoffer
library(astsa)
# Previous data preparation
temp = tempr-mean(tempr) # center temperature
temp2 = temp^2
trend = time(cmort) # time
# HW Edit: Set part(t-4) value
partm4 = lag(part,k=-4)
# HW Edit: added part(t-4) value to model
# Note: rather than manually separate head/tail 4 values for each feature, the na.action flag was set to "na.omit" allowing the lm function to overlook them automatically
fit = lm(cmort~ trend + temp + temp2 + part + partm4, na.action="na.omit")
summary(fit) # regression results
summary(aov(fit)) # ANOVA table
summary(aov(lm(cmort~cbind(trend, temp, temp2, part)))) # Table 2.1
num = length(cmort) # sample size
AIC(fit)/num - log(2*pi) # AIC
AIC(fit, k=log(num))/num - log(2*pi) # BIC
(AICc = log(sum(resid(fit)^2)/num) + (num+5)/(num-5-2)) # AICc
summary(fit) # regression results
summary(aov(fit)) # ANOVA table
summary(aov(lm(cmort~cbind(trend, temp, temp2, part,partm4)))) # Table 2.1
num = length(cmort) # sample size
AIC(fit)/num - log(2*pi) # AIC
AIC(fit, k=log(num))/num - log(2*pi) # BIC
(AICc = log(sum(resid(fit)^2)/num) + (num+5)/(num-5-2)) # AICc
summary(aov(lm(cmort~cbind(trend, temp, temp2, part,partm4),na.action="na.omit"))) # Table 2.1
?aov
summary(aov(lm(cmort~cbind(trend, temp, temp2, part,partm4)),na.action="na.omit")) # Table 2.1
summary(aov(lm(cmort~cbind(trend, temp, temp2, part,partm4[-(1:4),-(1:4)])),na.action="na.omit")) # Table 2.1
(AICc = log(sum(resid(fit)^2)/num) + (num+5)/(num-5-2)) # AICc
?AIC
AIC(fit)/num - log(2*pi) # AIC (fit1)
# Components of code provided in textbook, courtesy of Shumway and Stoffer
library(astsa)
# Previous data preparation
temp = tempr-mean(tempr) # center temperature
temp2 = temp^2
trend = time(cmort) # time
# HW Edit: Set part(t-4) value
partm4 = lag(part,k=-4)
# HW Edit: added part(t-4) value to model
fit = lm(cmort~ trend + temp + temp2 + part)
# Note: rather than manually separate head/tail 4 values for each feature, the na.action flag was set to "na.omit" allowing the lm function to overlook them automatically
fit2 = lm(cmort~ trend + temp + temp2 + part + partm4, na.action="na.omit")
# Comparison of models
AIC(fit)/num - log(2*pi) # AIC (fit1)
AIC(fit2)/num - log(2*pi) # AIC (fit2)
?lm
fit2 = lm(cmort~ trend + temp + temp2 + part + partm4, na.action="na.exclude")
AIC(fit)/num - log(2*pi) # AIC (fit1)
AIC(fit2)/num - log(2*pi) # AIC (fit2)
fit2 = lm(cmort~ trend + part + partm4, na.action="na.exclude")
AIC(fit)/num - log(2*pi) # AIC (fit1)
AIC(fit2)/num - log(2*pi) # AIC (fit2)
fit2 = lm(cmort~ trend + temp + temp2 + partm4, na.action="na.exclude")
# Comparison of models
AIC(fit)/num - log(2*pi) # AIC (fit1)
AIC(fit2)/num - log(2*pi) # AIC (fit2)
fit = lm(cmort~ part)
# Note: rather than manually separate head/tail 4 values for each feature, the na.action flag was set to "na.omit" allowing the lm function to overlook them automatically
fit2 = lm(cmort~ partm4, na.action="na.exclude")
# Comparison of models
AIC(fit)/num - log(2*pi) # AIC (fit1)
AIC(fit2)/num - log(2*pi) # AIC (fit2)
num = length(cmort) # sample size
num2 = length(cmort - 8) # sample size 2
AIC(fit)/num - log(2*pi) # AIC (fit1)
AIC(fit2)/num2 - log(2*pi) # AIC (fit2)
AIC(fit, k=log(num))/num - log(2*pi) # BIC
AIC(fit2, k=log(num2))/num - log(2*pi) # BIC (fit2)
(AICc = log(sum(resid(fit)^2)/num) + (num+5)/(num-5-2)) # AICc
(AICc = log(sum(resid(fit2)^2)/num2) + (num+5)/(num-5-2)) # AICc (fit2)
fit = lm(cmort~ trend + temp + temp2 + part)
# Note: rather than manually separate head/tail 4 values for each feature, the na.action flag was set to "na.omit" allowing the lm function to overlook them automatically
fit2 = lm(cmort~ trend + temp + temp2 + part + partm4, na.action="na.exclude")
fit1
fit
fit2
?lm
x
y
partm4
dim(partm4)
length(partm4)
length(partm4[-(1:4),-(1:4)])
length(partm4[-(1:4)])
head(partm4)
head(partm4[-1,])
head(partm4[-1])
head(partm4[1])
head(partm4)[-1]
head(partm4)[-2]
head(partm4)[-1:2]
head(partm4)[-(1:2)]
head(partm4)[-(1:3)]
tail(partm4)
x = partm4
x
y = x[-c(1:4,length(x)-4:length(x))]
length(y)
y
y = x[-c(1:4]
y = x[-c(1:4)]
length(y)
y = x[-(1:4,length(x)-4:length(x))]
y = x[-c(1:4,length(x)-4:length(x))]
y
y = x[-c(head(x,4),tail(x,4))]
length(y)
length(x)
length(partm4)
length(part)
length(temp)
?filter
?slice
y = x[!c(head(x,4),tail(x,4))]
length()
length(y)
library(astsa)
# Previous data preparation
temp = tempr-mean(tempr) # center temperature
temp2 = temp^2
trend = time(cmort) # time
length(temp)
partm4 = lag(part,k=-4)
length(partm4)
head(cbind(part,partm4));
tail(cbind(part,partm4))
length(part)
head(cbind(part,partm4));
tail(cbind(part,partm4,temp))
x <- cbind(part,partm4)
head(x)
tail(y)
tail(x)
y = x[5:508]
y
head(y)
y = x[5:508,]
y
head(x)
head(y)
library(astsa)
# Previous data preparation
temp = tempr-mean(tempr) # center temperature
temp2 = temp^2
trend = time(cmort) # time
# HW Edit: Set part(t-4) value
partm4 = lag(part,k=-4)
# Trimmed variables by 4
temp = temp[5:108]
temp2 = temp2[5:108]
trend = trend[5:108]
part = part[5:108]
partm4 = partm4[1:104]
fit = lm(cmort~ trend + temp + temp2 + part)
fit2 = lm(cmort~ trend + temp + temp2 + part + partm4)
length(temp)
length(trend)
length(partm4)
test = cbind(temp,temp2,trend,part,partm4)
head(test)
tail(test)
dim(cmort)
head(cmort)
length(cmort)
library(astsa)
length(temp)
temp = temp[5:508]
tail(temp)
num
dataset(cmort)
data(cmort)
length(temp)
data(cmort)
library(astsa)
data(cmort)
# Previous data preparation
temp = tempr-mean(tempr) # center temperature
temp2 = temp^2
trend = time(cmort) # time
# HW Edit: Set part(t-4) value
partm4 = lag(part,k=-4)
length(partm4)
length(part)
length(temp)
library(astsa)
data(cmort)
length(part)
library(astsa)
data(cmort)
length(part)
length(partm4)
library(astsa)
data(cmort)
# Previous data preparation
temp = tempr-mean(tempr) # center temperature
temp2 = temp^2
trend = time(cmort) # time
# HW Edit: Set part(t-4) value
partm4 = lag(part,k=-4)
# Trimmed variables by 4
temp = temp[5:508]
temp2 = temp2[5:508]
trend = trend[5:508]
part = part[5:508]
cmort = cmort[5:508]
partm4 = partm4[1:504]
# HW Edit: added part(t-4) value to model fit2
fit = lm(cmort~ trend + temp + temp2 + part)
fit2 = lm(cmort~ trend + temp + temp2 + part + partm4)
# Comparison of models
num = length(cmort) # sample size
num2 = length(cmort - 8) # sample size 2
AIC(fit)/num - log(2*pi) # AIC (fit1)
AIC(fit2)/num2 - log(2*pi) # AIC (fit2)
AIC(fit, k=log(num))/num - log(2*pi) # BIC
AIC(fit2, k=log(num2))/num - log(2*pi) # BIC (fit2)
(AICc = log(sum(resid(fit)^2)/num) + (num+5)/(num-5-2)) # AICc
(AICc = log(sum(resid(fit2)^2)/num2) + (num+5)/(num-5-2)) # AICc (fit2)
pairs(cbind(Mortality=cmort, Temperature=tempr, Particulates=part,ParticulatesTMinus4=partm4))
cor(cbind(Mortality=cmort, Temperature=tempr,
pairs(cbind(Mortality=cmort, Temperature=temp, Particulates=part,ParticulatesTMinus4=partm4))
cor(cbind(Mortality=cmort, Temperature=temp, Particulates=part,ParticulatesTMinus4=partm4),use="complete.obs")
cor(cbind(Mortality=cmort, Temperature=temp, Particulates=part,ParticulatesTMinus4=partm4),use="complete.obs")
pairs(cbind(Mortality=cmort, Temperature=tempr, Particulates=part,ParticulatesTMinus4=partm4))
pairs(cbind(Mortality=cmort, Temperature=temp, Particulates=part,ParticulatesTMinus4=partm4))
cor(cbind(Mortality=cmort, Temperature=temp, Particulates=part,ParticulatesTMinus4=partm4),use="complete.obs")
setwd("~/Sentiment/news_updater")
